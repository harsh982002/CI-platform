@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@using System.Security.Claims;
@model CIPlatform.Entitites.ViewModel.Mission
@{
    foreach (var item in Model.Missions)
    {
        <div class="item col-md-6 col-lg-4 col-sm-6 mt-3">
            <div class="thumbnail card d-flex">
                <div class="img-event">
                    <img class="group list-group-image w-100 h-100"
                 src='@item.MissionMedia.ElementAt(0).MediaPath' alt="" id='@item.MissionMedia.ElementAt(0).MissionMediaId-@item.MissionMedia.ElementAt(0).MediaPath' onmouseover="view_detail_onmouseover(@item.MissionId,'@item.MissionMedia.ElementAt(0).MissionMediaId-@item.MissionMedia.ElementAt(0).MediaPath')" onmouseout="view_detail_onmouseout(@item.MissionId,'@item.MissionMedia.ElementAt(0).MissionMediaId-@item.MissionMedia.ElementAt(0).MediaPath')" />
                    <div class="location-img">
   
                        <img class="text-light" src="/images/pin.png" alt="">
                        <span class="text-light">@item.City.Name</span>
                    </div>
                      <button class="like-img border-0" >
                            <img class="text-light" src="/images/heart.png" alt="">
                        </button>
                    <button class="stop-img border-0">
                        <img class="text-light" src="/images/user.png" alt="">
                    </button>
                    <button class="mission-theme border-0" >
                        <span class="p-2">@item.Theme.Title</span>
                    </button>
                    <div class="view-detail position-absolute" style="display:none;" onmouseover="view_detail_onmouseover(@item.MissionId,'@item.MissionMedia.ElementAt(0).MissionMediaId-@item.MissionMedia.ElementAt(0).MediaPath')" onmouseout="view_detail_onmouseout(@item.MissionId,'@item.MissionMedia.ElementAt(0).MissionMediaId-@item.MissionMedia.ElementAt(0).MediaPath')" id=@item.MissionId>
                        <a href='/volunteering_mission/@item.MissionId' class="applyButton  btn d-flex  justify-content-around align-items-center" style="border: 2px solid white; color: white;">
                                View Details <img class="ms-2" src="images/right-arrow.png" alt="">
                        </a>
                    </div>
                </div>
                <div class="caption card-body">
                    <h4 class="group card-title inner list-group-item-heading">
                        @item.Title?.Substring(0,30)...
                    </h4>
                    <p class="group inner list-group-item-text">
                        @item.Description?.Substring(0,100).....
                    </p>
                    <div class="d-flex list-view justify-content-between">
                        <span class="organization">@item.OrganizationName</span>
                        
                    </div>
                    <div class="duration-seats-info mt-4">
                        <div class="duration">
                            @{
                                if (@item.MissionType == "GOAL")
                                {
                                    <p id="duration-txt" style="margin-bottom: 0;">@item.GoalObject</p>
                                }
                                else
                                {
                                    <p id="duration-txt" style="margin-bottom: 0;">From @item.StartDate?.ToString().Substring(0,10) To @item.EndDate?.ToString().Substring(0,10)</p>
                                }
                            }
                        </div>
                    </div>
                    <div class="d-flex justify-content-between border-bottom mt-3">
                        <div class="Seats d-flex align-items-center">
                            <img src="/images/Seats-left.png" alt="">
                            <span>
                                @item.AvbSeat <p>seats left</p>
                            </span>
                        </div>
                        <div class="deadline d-flex align-items-center">
                            @{
                                if (@item.MissionType == "GOAL")
                                {
                                    string? str1 = @item.GoalObject;
                                    string str2 = string.Empty;
                                    int goal = 0;
                                    for (int i = 0; i <= str1.Length - 1; i++)
                                    {
                                        if (Char.IsDigit(str1[i]))
                                            str2 += str1[i];
                                    }
                                    if (str2.Length > 0)
                                    {
                                        goal = int.Parse(str2);
                                    }
                                    double? percent = (@item.Achieved / (double)goal) * 100;
                                    <img src="/images/achieved.png" alt="">
                                    <div class="w-100">
                                        <div class="progress" style="width:90%;margin-left:10px;">
                                            <div class="progress-bar" role="progressbar" style="width:@percent%" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                        <p class="text-muted">@item.Achieved achieved</p>
                                    </div>
                                }
                                else
                                {
                                    <img src="/images/deadline.png" alt="">
                                    <span>
                                        @item.Deadline?.ToString().Substring(0,10)
                                        <p>Deadline</p>
                                    </span>
                                }
                            }

                        </div>
                    </div>
                    <div class="d-flex justify-content-center mt-4">
                     <a class="applyButton btn"  asp-action="Volunteermission" asp-controller="Home" asp-route-id="@item.MissionId" >    
                    
                            Apply <img src="/images/right-arrow.png" alt="">
                       
                        </a>
                    </div>
                </div>
            </div>
        </div>

    }
}
